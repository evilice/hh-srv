# API для работы с вакансиями и откликами

## Endpoints для Employer

### 1. Получение вакансии с детальной информацией об откликах

**GET** `/vacancies/:vacancy_id`

**Описание:** Получение детальной информации о вакансии. Для employer возвращается полная информация с откликами, для seeker - базовая информация с статусом отклика.

**Требования авторизации:** JWT токен

**Параметры:**

- `vacancy_id` (path) - ID вакансии

**Ответ для EMPLOYER (если это его вакансия):**

```json
{
  "id": 1,
  "title": "Frontend Developer",
  "description": "Описание вакансии",
  "salary_min": "80000",
  "salary_max": "120000",
  "is_active": true,
  "createdAt": "2024-01-15T10:00:00Z",
  "updatedAt": "2024-01-15T10:00:00Z",
  "employer": {
    "id": 1,
    "firstName": "Иван",
    "lastName": "Иванов",
    "company": "Tech Corp"
  },
  "test": {
    "id": 1,
    "title": "Frontend Test",
    "type": "special",
    "description": "Тест по фронтенду"
  },
  "responses": [
    {
      "id": 1,
      "status": "pending",
      "createdAt": "2024-01-16T09:00:00Z",
      "updatedAt": "2024-01-16T09:00:00Z",
      "seeker": {
        "id": 2,
        "firstName": "Петр",
        "lastName": "Петров",
        "email": "petr@example.com",
        "company": "Previous Corp"
      },
      "testResults": [
        {
          "id": 1,
          "completedAt": "2024-01-16T10:00:00Z",
          "test": {
            "id": 1,
            "title": "Frontend Test",
            "type": "special"
          },
          "userAnswers": 15
        }
      ]
    }
  ],
  "totalResponses": 1,
  "pendingResponses": 1,
  "acceptedResponses": 0,
  "rejectedResponses": 0
}
```

**Ответ для SEEKER:**

```json
{
  "id": 1,
  "title": "Frontend Developer",
  "description": "Описание вакансии",
  "salary_min": "80000",
  "salary_max": "120000",
  "is_active": true,
  "createdAt": "2024-01-15T10:00:00Z",
  "updatedAt": "2024-01-15T10:00:00Z",
  "employer": {
    "id": 1,
    "firstName": "Иван",
    "lastName": "Иванов",
    "company": "Tech Corp"
  },
  "test": {
    "id": 1,
    "title": "Frontend Test",
    "type": "special",
    "description": "Тест по фронтенду"
  },
  "hasPassedSpecialTest": true,
  "response": {
    "id": 1,
    "status": "pending",
    "createdAt": "2024-01-16T09:00:00Z"
  },
  "hasMyResponse": true
}
```

### 2. Изменение статуса отклика

**PUT** `/responses/:id/status`

**Описание:** Изменение статуса отклика (pending → accepted/rejected)

**Требования авторизации:** JWT токен + роль EMPLOYER

**Параметры:**

- `id` (path) - ID отклика

**Тело запроса:**

```json
{
  "status": "accepted" // или "rejected"
}
```

**Возможные статусы:**

- `pending` - ожидает рассмотрения
- `accepted` - принят
- `rejected` - отклонен

**Ответ:** Обновленный объект отклика

## Endpoints для Seeker

### 1. Создание отклика на вакансию

**POST** `/responses`

**Описание:** Создание отклика на вакансию

**Требования авторизации:** JWT токен + роль SEEKER

**Тело запроса:**

```json
{
  "vacancyId": 1
}
```

### 2. Получение своих откликов

**GET** `/responses/seeker`

**Описание:** Получение списка откликов текущего соискателя

**Требования авторизации:** JWT токен + роль SEEKER

## Общие endpoints

### 1. Получение вакансии (общий для всех ролей)

**GET** `/vacancies/:vacancy_id`

**Описание:** Получение информации о вакансии. Возвращает разную информацию в зависимости от роли пользователя:

- **EMPLOYER** (если это его вакансия): полная информация + отклики + статистика
- **SEEKER**: базовая информация + статус отклика + результат теста
- **Другие роли**: только базовая информация

**Требования авторизации:** JWT токен

### 2. Получение списка активных вакансий

**GET** `/vacancies`

**Описание:** Получение списка активных вакансий с пагинацией

**Требования авторизации:** JWT токен + роль SEEKER

**Query параметры:**

- `page` (опционально) - номер страницы (по умолчанию 1)
- `limit` (опционально) - количество элементов на странице (по умолчанию 10)

### 3. Создание вакансии

**POST** `/vacancies`

**Описание:** Создание новой вакансии

**Требования авторизации:** JWT токен + роль EMPLOYER

**Тело запроса:**

```json
{
  "title": "Название вакансии",
  "description": "Описание вакансии",
  "salary_min": "80000",
  "salary_max": "120000",
  "is_active": true,
  "testId": 1
}
```

### 4. Обновление вакансии

**PUT** `/vacancies/:vacancy_id`

**Описание:** Обновление существующей вакансии

**Требования авторизации:** JWT токен + роль EMPLOYER

### 5. Удаление вакансии

**DELETE** `/vacancies/:vacancy_id`

**Описание:** Удаление вакансии

**Требования авторизации:** JWT токен + роль EMPLOYER

### 6. Получение своих вакансий (для employer)

**GET** `/vacancies/my-vacancies`

**Описание:** Получение списка вакансий текущего работодателя

**Требования авторизации:** JWT токен + роль EMPLOYER

## Статусы откликов

- **pending** - ожидает рассмотрения
- **accepted** - принят работодателем
- **rejected** - отклонен работодателем

## Примечания

1. Все endpoints требуют JWT авторизации
2. Роли проверяются через RolesGuard
3. Employer может изменять статус только откликов на свои вакансии
4. Seeker может создавать отклики только на активные вакансии
5. Endpoint `GET /vacancies/:vacancy_id` работает для всех ролей, но возвращает разную информацию:
   - **EMPLOYER** получает полную информацию об откликах и соискателях
   - **SEEKER** получает информацию о вакансии и своем отклике
   - **Другие роли** получают только базовую информацию о вакансии
